function editBio(event){var ct=event.currentTarget;if(ct.classList.contains('done')){closeRight();resetCardSets();return;}
resetCardSets();ct.classList.add('loading');var formData=new FormData;formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/pan/editbio.pan.php",data:formData,contentType:false,processData:false,success:function(result){if(result.includes('error=')&&result.length<50){errorAlerts(result);ct.classList.remove('loading');}else{setTimeout(function(){var container=document.querySelector('section.right span.content');container.innerHTML=result;openSection();editBioOn();ct.classList.add('done');},200)}}});}
function ifTextEdits(event){if(event.keyCode==13){event.preventDefault();}
var ct=event.currentTarget;var mainInfo=ct.parentElement;var newVal=ct.value.replace(/\n*$/,"");ct.value=newVal;var needEdit=0;var inputs=mainInfo.querySelectorAll('textarea');for(i=0;i<inputs.length;i++){var tA=inputs[i];var domVal=tA.getAttribute('data-pre');var curVal=tA.value;if(domVal!=curVal){needEdit=1;}if(curVal==''||curVal.trim().length===0){needEdit=0;break;}}
if(needEdit==1){mainInfo.classList.add('edit');}else{mainInfo.classList.remove('edit');}}
function changeBio(){var container=document.querySelector('.edit_bio');var nameEl=container.querySelector('textarea.user_name_input');var bioEl=container.querySelector('textarea.user_bio_input');var button=container.querySelector('[name="edit_bio_submit"]');button.classList.add('prog');prog(button.querySelector('svg.prog'),99);var formData=new FormData;if(nameEl.getAttribute('data-pre')!=nameEl.value){formData.append('name',nameEl.value);}if(bioEl.getAttribute('data-pre')!=bioEl.value){formData.append('bio',bioEl.value);}
formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/editbio.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){prog(button.querySelector('svg.prog'),101);nameEl.setAttribute('data-pre',nameEl.value);bioEl.setAttribute('data-pre',bioEl.value);var prof=document.querySelector('biome.main_user_info .profile_info');prof.querySelector('h1').innerHTML=encode(nameEl.value);prof.querySelector('h3 .content').innerHTML=encode(bioEl.value);var set=document.querySelector('.card_setting[name="edit_bio"] .profile_info');set.querySelector('h1').innerHTML=encode(nameEl.value);set.querySelector('h3 .content').innerHTML=encode(bioEl.value);setTimeout(function(){document.querySelector('.edit_bio .editables').classList.remove('edit');setTimeout(function(){button.classList.remove('prog');},200)},800)}else{errorAlerts(result);button.classList.remove('prog');}}});}
function editPfp(event){var ct=event.currentTarget;if(ct.classList.contains('done')){closeRight();resetCardSets();return;}
resetCardSets();ct.classList.add('loading');var formData=new FormData;var pfpURL=document.querySelector('.prof_container').getAttribute('data-pfpurl');formData.append('pfpURL',pfpURL);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/pan/editpfp.pan.php",data:formData,contentType:false,processData:false,success:function(result){if(result.includes('error=')&&result.length<50){errorAlerts(result);ct.classList.remove('loading');}else{setTimeout(function(){var container=document.querySelector('section.right span.content');container.innerHTML=result;openSection();editPfpOn();ct.classList.add('done');},200)}}});}
var allShapes=['circle','scallop','diamond','blob','squircle','star','cloud','pentagon','crescent','triangle','semicircle','bolt'];function changeShape(event){var chooser=document.querySelector('.shape_chooser');var domShape=chooser.getAttribute('data-pre');var ct=event.currentTarget;curShape=ct.getAttribute('data-shape');if(curShape!=domShape){var all=chooser.querySelectorAll('button');for(var i=0;i<all.length;i++){all[i].classList.remove('active');}
ct.classList.add('active');chooser.setAttribute('data-pre',curShape);var masks=document.querySelectorAll('.final_shape');for(var i=0;i<masks.length;i++){for(var ii=0;ii<allShapes.length;ii++){masks[i].classList.remove(allShapes[ii]);}
masks[i].classList.add(curShape);}
var formData=new FormData;formData.append('shape',curShape);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/editshape.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){}else{errorAlerts(result);}}})}}
function pfpPreview(event){var ct=event.currentTarget;var file=ct.files[0];var fileSize=file.size;if(fileSize<16000000){var fileName=file.name;var ext=fileName.substr(fileName.lastIndexOf('.')+1);if(ext=='png'||ext=='jpeg'||ext=='jpg'){var img=document.createElement('img');var container=document.querySelector('.pfp_editor .to_edit');var reader=new FileReader();reader.onload=function(e){img.setAttribute('src',e.target.result);img.onload=function(){var ratio=this.height/this.width;var canvas=document.createElement('canvas');canvas.width=200;canvas.height=200;var context=canvas.getContext("2d");if(ratio>1){var height=200*ratio;var top=((height-200)/2)/(height/this.height)
context.scale(200/this.width,height/this.height);context.drawImage(this,0,-top);}else if(ratio<1){var width=200/ratio;var left=((width-200)/2)/(width/this.width)
context.scale(width/this.width,200/this.height);context.drawImage(this,-left,0);}else{context.scale(200/this.width,200/this.height);context.drawImage(this,0,0);}
var pfpPrev=document.querySelector('image.pfp_preview');var editables=document.querySelector('.edit_pfp .editables');if(!editables.hasAttribute('data-pre')){editables.setAttribute('data-pre',pfpPrev.getAttribute('xlink:href'));}
pfpPrev.setAttribute('xlink:href',canvas.toDataURL());editables.classList.add('edit');editables.classList.remove('unlink');scrollBarHeights();}};reader.readAsDataURL(file);}else{sendAlert('Sorry, that file type is not supported. Please try a different file','Ok','yep');}}else{sendAlert('Sorry, that file is too large. Please compress it or try a different file','Ok','yep');}}
function undoPfpChanges(){var editables=document.querySelector('.edit_pfp .editables');var pfpPrev=document.querySelector('image.pfp_preview');pfpPrev.setAttribute('xlink:href',editables.getAttribute('data-pre'));editables.classList.remove('edit');scrollBarHeights();}
function pfpMiniView(event){var ct=event.currentTarget;var head=ct.parentElement.parentElement.querySelector('.exp_header');var editor=document.querySelector('.rounded_panel.pfp_editor');var mini=document.querySelector('.pfp_mini_prev');if(ct.scrollTop>editor.offsetHeight){if(!mini.classList.contains('active')){var prev=document.querySelector('.pfp_editor .to_edit .final_shape');var clPrev=prev.cloneNode(true);mini.innerHTML='';mini.appendChild(clPrev);mini.classList.add('active');}}else{mini.classList.remove('active');}}
function changePfp(event){if(document.querySelector('.edit_pfp .editables').classList.contains('unlink')){var formData=new FormData;var editables=document.querySelector('.edit_pfp .editables');editables.classList.remove('edit','unlink');formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/removepfp.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){var mainPfp=document.querySelector('.main_user_info .profile_info .profile_img image');var update=makeCode();var src=`${mainPfp.getAttribute('xlink:href')}&update=${update}`;mainPfp.setAttribute('xlink:href',src);document.querySelector('[name="main_button_gallery"] .main_user_button img').setAttribute('src',src);document.querySelector('.prof_container').setAttribute('data-pfpurl',src);editMenuPfp();}else{errorAlerts(result);undoPfpChanges();}}})}else{var file=document.querySelector('.pfp_input').files[0];var fileSize=file.size;if(fileSize<16000000){var fileName=file.name;var ext=fileName.substr(fileName.lastIndexOf('.')+1);if(ext=='png'||ext=='jpeg'||ext=='jpg'){var ct=event.currentTarget
var formData=new FormData();formData.append('file',file);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ct.classList.add('prog');var final=document.querySelector('.pfp_final_upload');ajaxRun=$.ajax({xhr:function(){var xhr=new window.XMLHttpRequest();xhr.upload.addEventListener("progress",function(evt){if(evt.lengthComputable){var percentComplete=evt.loaded/evt.total;percentComplete=parseInt(percentComplete*100);prog(final,percentComplete);}},false);return xhr;},url:'includes/editpfp.inc.php',type:"POST",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){prog(final,101);var mainPfp=document.querySelector('.main_user_info .profile_info .profile_img image');var update=makeCode();var src=`${mainPfp.getAttribute('xlink:href')}&update=${update}`;mainPfp.setAttribute('xlink:href',src);document.querySelector('[name="main_button_gallery"] .main_user_button img').setAttribute('src',src);document.querySelector('.prof_container').setAttribute('data-pfpurl',src);editMenuPfp();setTimeout(function(){document.querySelector('.edit_pfp .editables').classList.remove('edit');},800)}else{errorAlerts(result);undoPfpChanges();}
setTimeout(function(){document.querySelector('.pfp_editor button.yep').classList.remove('prog');},1000)}})}}}}
function unlinkPfp(){var editables=document.querySelector('.edit_pfp .editables');editables.classList.add('edit','unlink');var pfpPrev=document.querySelector('image.pfp_preview');if(!editables.hasAttribute('data-pre')){editables.setAttribute('data-pre',pfpPrev.getAttribute('xlink:href'));}
pfpPrev.setAttribute('xlink:href','https://hydr.in/includes/img/default.png');scrollBarHeights();}
function editColor(event){var ct=event.currentTarget;if(ct.classList.contains('done')){closeRight();resetCardSets();return;}
resetCardSets();ct.classList.add('loading');var formData=new FormData;formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/pan/editcolor.pan.php",data:formData,contentType:false,processData:false,success:function(result){if(result.includes('error=')&&result.length<50){errorAlerts(result);ct.classList.remove('loading');}else{setTimeout(function(){var container=document.querySelector('section.right span.content');container.innerHTML=result;openSection();editColorOn();ct.classList.add('done');},200)}}});}
function loadVibrant(){var vibrant=document.querySelector('script.vibrant');if(!vibrant){var script=document.createElement('script');script.classList.add('vibrant');script.setAttribute('src','includes/js/vibrant.js');document.body.appendChild(script);var script=document.querySelector('script.vibrant');script.addEventListener('load',function(){genImgColor();});}
else{genImgColor();}}
function genImgColor(){var par=document.querySelector('.gen_from_pfp .color_options');var button=document.querySelector('.extra[name="edit_color_from_pfp"]');if(!par.classList.contains('active')){button.classList.add('loading');var img=document.createElement('img');var src=document.querySelector('meta[property="og:image"]').content;img.setAttribute('src',src);img.addEventListener('load',function(){var vibrant=new Vibrant(img);var swatches=vibrant.swatches();var html='';var sheet=document.querySelector('.profile_styles').sheet;for(var swatch in swatches){if(swatches.hasOwnProperty(swatch)&&swatches[swatch]){var hex=swatches[swatch].getHex();swatch=swatch.toLowerCase();var opt=document.createElement('div');opt.classList.add('option',swatch);opt.setAttribute('data-hex',hex);par.appendChild(opt);opt.style.background=hex;opt.addEventListener('click',changeFromPfp,false);}}
par.classList.add('active');par.parentElement.classList.add('active');button.classList.remove('loading');});}}
function correctHex(event){var ct=event.currentTarget;var val=ct.value;val=val.replace(/[^A-Fa-f0-9]/g,'');if(val!=''){val='#'+val;}
ct.value=val;if(val.length==7){changePrevColor(val);}}
function changeFromPfp(event){var ct=event.currentTarget;var val=ct.getAttribute('data-hex');changePrevColor(val);}
function changeFromColIn(event){var ct=event.currentTarget;var val=ct.value;changePrevColor(val);}
function changePrevColor(val){var contrast=getContrast(val);document.querySelector('.main_color_panel .main_button button.button.singular:nth-child(2)').style.background=val;document.querySelector('.main_color_panel .main_button button.button.singular.bg').style.background=val;document.querySelector('.main_color_panel .main_button button.button.singular:nth-child(2) h3').style.color=contrast;document.querySelector('.main_color_panel.featured_action .bg').style.color=luma(val.substring(1),95);var par=document.querySelector('.edit_color .editables');par.classList.add('edit');var final=document.querySelector('.final_color_select');var picker=document.querySelector('input.color_picker');final.value=val;picker.value=val;}
function toggleTheme(){var container=document.querySelector('.theme_chooser');var body=document.body;var cardSettings=document.querySelectorAll('.card_setting');var formData=new FormData;for(var i=0;i<cardSettings.length;i++){cardSettings[i].style.transition='background 0.2s';}
if(container.classList.contains('dark')){container.classList.remove('dark');container.classList.add('light');body.classList.remove('dark');body.classList.add('light');formData.append('theme','l');}else{container.classList.add('dark');container.classList.remove('light');body.classList.remove('light');body.classList.add('dark');formData.append('theme','d');}
formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/edittheme.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){}else{errorAlerts(result);}}});setTimeout(function(){for(var i=0;i<cardSettings.length;i++){cardSettings[i].style.transition='';}},200)}
function undoColorChanges(){var par=document.querySelector('.edit_color .editables');var pre=par.getAttribute('data-pre');changePrevColor(pre);par.classList.remove('edit');}
function changeColor(event){var ct=event.currentTarget;ct.classList.add('prog');var final=document.querySelector('.color_final_save');prog(final,100);var val=document.querySelector('.final_color_select').value;var formData=new FormData;formData.append('color',val);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/editcolor.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){var par=document.querySelector('.edit_color .editables');par.setAttribute('data-pre',val);var final=document.querySelector('.color_final_save');prog(final,101);document.querySelector('.prof_container').style.setProperty('background',val);document.querySelector('meta[name="theme-color"]').setAttribute('content',val);var bgHolder=document.querySelector('span[data-name="hydrin_bg_holder"]');if(bgHolder){bgHolder.setAttribute('data-color',val.replace('#',''));resetBGRolls();loadBackground();}
themeDetermine('update');}else{errorAlerts(result);}
setTimeout(function(){undoColorChanges();setTimeout(function(){ct.classList.remove('prog');},200)},800)}});}
function loadBackground(){var bgHolder=document.querySelector('span[data-name="hydrin_bg_holder"]');if(bgHolder){var color=bgHolder.getAttribute('data-color')||'000000';var id=bgHolder.getAttribute('data-id');if(!id)return;if(id=='null'){var canvas=bgHolder.querySelector('canvas');if(canvas){canvas.style.animation='fade_out 0.3s';setTimeout(function(){canvas.remove();},300);}
return;}
var canvas=document.createElement('canvas');var context=canvas.getContext('2d');var density=window.devicePixelRatio;bg=new Image();bg.src=`includes/bg.inc.php?id=${id}&c=${color}`;bg.onload=function(){var bgRatio=this.height/this.width;if(screen.width>screen.height){var bgWidth=screen.width*density;var bgHeight=bgWidth*bgRatio;}else{var bgHeight=screen.height*density;var bgWidth=bgHeight/bgRatio;}
context.canvas.width=bgWidth
context.canvas.height=bgHeight;context.drawImage(bg,0,0,bgWidth,bgHeight);if(document.querySelector('.loading_area.active')){bgHolder.appendChild(canvas);if(document.querySelector('.prof_container.expand')){setTimeout(function(){pageEnter();},200)}else pageEnter();}else{canvas.style.animation='fade_in 0.3s';bgHolder.appendChild(canvas);setTimeout(function(){bgHolder.removeChild(bgHolder.lastChild.previousSibling);canvas.style.animation='';},300)}}}}
function setBackground(event){var ct=event.currentTarget;if(ct.classList.contains('active'))return;var bgHolder=document.querySelector('[data-name="hydrin_bg_holder"]');if(bgHolder){var id=ct.getAttribute('data-id');if(!id)id=null;bgHolder.classList.add('active');bgHolder.setAttribute('data-id',id);var allRolls=document.querySelector('[data-name="edit_bg_container"]').querySelectorAll('roll');for(var i=0;i<allRolls.length;i++){if(allRolls[i].classList.contains('active')){allRolls[i].classList.remove('active');bgRollOut(allRolls[i],15);}}
document.querySelector('[data-name="no_wallpaper_selector"]').classList.remove('active');ct.classList.add('active');var formData=new FormData;formData.append('background',id);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/editbackground.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){var bgHolder=document.querySelector('span[data-name="hydrin_bg_holder"]');async function addFooter(){const creditMessage=await fetch(`https://hydr.in/includes/bg.inc.php?id=${id}&info`);const creditHTML=await creditMessage.text();var bgCredits=document.querySelectorAll('.wallpaper_credit_parent');for(var i=0;i<bgCredits.length;i++){if(creditHTML)bgCredits[i].classList.add('active');else bgCredits[i].classList.remove('active');bgCredits[i].innerHTML=creditHTML;}}
addFooter();if(bgHolder){bgHolder.setAttribute('data-id',id);loadBackground();}}else{errorAlerts(result);}}});}}
function resetBGRolls(){var rollContainer=document.querySelector('[data-name="edit_bg_container"]');if(!rollContainer)return;var rolls=rollContainer.querySelectorAll('roll');var color=document.querySelector('[data-name="hydrin_bg_holder"]').getAttribute('data-color');for(var i=0;i<rolls.length;i++){var rollId=rolls[i].getAttribute('data-id');var density=window.devicePixelRatio;bg=new Image();bg.src=`includes/bg.inc.php?id=${rollId}&c=${color}&thumb`;bg.setAttribute('id',rollId);bg.onload=function(){var canvas=document.createElement('canvas');var context=canvas.getContext('2d');var bgWidth=490*density;var bgHeight=413*density;context.canvas.width=bgWidth
context.canvas.height=bgHeight;context.drawImage(this,0,0,bgWidth,bgHeight);var src=canvas.toDataURL();var svgParent=document.querySelector(`roll[data-id="${this.getAttribute('id')}"] svg.bg_roll`);const prevImage=Array.from(svgParent.querySelectorAll('.shaped_image')).pop();prevImage.insertAdjacentHTML('afterend',`<image style='${prevImage.getAttribute('style')}; animation: fade_in 0.4s' class="shaped_image" width="100%" height="100%" xlink:href="${src}"></image>`);setTimeout(function(){prevImage.nextElementSibling.setAttribute('style',prevImage.getAttribute('style'));prevImage.remove();},400)}}}
function undoBioChanges(){var inputs=document.querySelector('scroll.edit_bio').querySelectorAll('textarea');for(var i=0;i<inputs.length;i++){var pre=inputs[i].getAttribute('data-pre');inputs[i].value=pre;}
document.querySelector('.edit_bio .editables').classList.remove('edit');scrollBarHeights();}
function openSecurity(event){resetCardSets();var ct=event.currentTarget;ct.classList.add('copied');var formData=new FormData;formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/pan/security.pan.php",data:formData,contentType:false,processData:false,success:function(result){if(result.includes('error=')&&result.length<50){errorAlerts(result);ct.classList.remove('copied');}else{setTimeout(function(){var container=document.querySelector('section.right span.content');container.innerHTML=result;openSection();securityPanelOn();ct.classList.remove('copied');},200)}}});}
function checkPassword(){var main=document.querySelector('.change_password_content'),curPass=main.querySelector('input[name="cur_pwd"]').value,newPass=main.querySelector('input[name="new_pwd"]').value,reNewPass=main.querySelector('input[name="re_new_pwd"]').value,passRules={letter:'f',upper:'f',num:'f',symb:'f',length:'f'},specialChars=`\`!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?~`,alpha=`abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ`,classes='xabcde',pwdCheck=0,checker=main.querySelector('.pass_checker');if(newPass.length>7){passRules.length='t';pwdCheck++;}
for(var i=0;i<newPass.length;i++){char=newPass.charAt(i);if(!isNaN(char*1)&&passRules.num=='f'){passRules.num='t';pwdCheck++;}else if(specialChars.includes(char)&&passRules.symb=='f'){passRules.symb='t';pwdCheck++;}else if(alpha.includes(char)){if(passRules.letter=='f'){passRules.letter='t';pwdCheck++;}
if(char==char.toUpperCase()&&passRules.upper=='f'){passRules.upper='t';pwdCheck++;}}}
checker.classList.remove('a','b','c','d','e');checker.classList.add(classes[pwdCheck]);var tooltipContent=`<span class='${passRules.letter}'>Using letters</span><br><span class='${passRules.upper}'>Using capital letters</span><br><span class='${passRules.num}'>Using numbers</span><br><span class='${passRules.symb}'>Using special symbols</span><br><span class='${passRules.length}'>8 or more characters</span>`;document.querySelector('.change_password_content .best_practices').innerHTML=tooltipContent;if(curPass&&newPass&&reNewPass&&newPass==reNewPass){main.classList.add('ready');}else{main.classList.remove('ready');}}
function openChangePassword(event){var ct=event.currentTarget;var main=ct.parentElement;if(main.classList.contains('active')){main.classList.remove('active');}else{main.classList.add('active');}}
function changePassword(){var main=document.querySelector('.change_password_content'),curPass=main.querySelector('input[name="cur_pwd"]').value,newPass=main.querySelector('input[name="new_pwd"]').value,reNewPass=main.querySelector('input[name="re_new_pwd"]').value,button=main.querySelector('button[name="edit_pass_submit"]'),formData=new FormData;formData.append('oldpwd',curPass);formData.append('newpwd',newPass);formData.append('newpwd-repeat',reNewPass);button.classList.add('prog');formData.append('rrrr',rrrr);var final=button.querySelector('.pwd_final_save');prog(final,100);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/changepwd.inc.php",data:formData,contentType:false,processData:false,success:function(result){if(result=='success'){performClearRememberMe('pwd');setTimeout(function(){if(result=='success'){main.querySelector('input[name="cur_pwd"]').value='';main.querySelector('input[name="new_pwd"]').value='';main.querySelector('input[name="re_new_pwd"]').value='';prog(final,101);setTimeout(function(){button.classList.remove('prog');main.classList.remove('ready');document.querySelector('.security_panel .editables').classList.remove('active');},700)}},200)}else{errorAlerts(result);prog(final,102);button.classList.remove('prog');}}});}
function clearRememberMe(){sendAlert("You are about to remove remember me from every device connected to your Dive account except this one. We recommend only performing this action if you feel your security is at risk","Clear it!","minus",performClearRememberMe);}
function performClearRememberMe(pwd){var formData=new FormData;formData.append('rrrr',rrrr);if(pwd){formData.append('newpwd','true');}
if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/logoutall.inc.php",data:formData,contentType:false,processData:false,success:function(result){setTimeout(function(){if(result=='success'){}else{errorAlerts(result);}},200)}});}
function toggleMidnightMode(){var parent=document.querySelector('span[data-name="midnight_mode_editables"]');var midnight=0;var midnightInlines=document.querySelectorAll('.inline_embed.midnight');if(parent.classList.contains('on'))parent.classList.remove('on');else{parent.classList.add('on');midnight=1;}
for(var i=0;i<midnightInlines.length;i++){if(midnight==1)midnightInlines[i].classList.add('active');else midnightInlines[i].classList.remove('active');}
var formData=new FormData;formData.append('midnight',midnight);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/midnight.inc.php",data:formData,contentType:false,processData:false,success:function(result){setTimeout(function(){if(result=='success'){}else{errorAlerts(result);}},200)}});}
function settingsCollapse(event){var ct=event.currentTarget;var parent=ct.parentElement;if(!parent.classList.contains('active'))var addBack=1;var allEditables=document.querySelector('scroll.security_panel').querySelectorAll('span.editables');for(var i=0;i<allEditables.length;i++){allEditables[i].classList.remove('active');}
if(addBack)parent.classList.add('active');}
function suspendAccount(){var parent=document.querySelector('[data-name="suspend_account_editables"]');var email=parent.querySelector('[data-name="sus_email"]').value;var button=parent.querySelector('[data-name="suspend_account_submit"]');button.classList.add('prog');prog(button.querySelector('svg.prog'),99);var formData=new FormData;formData.append('mail',email);formData.append('action','TEMP-SUSPEND');formData.append('pwd','');formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/deleteaccount.inc.php",data:formData,contentType:false,processData:false,success:function(result){setTimeout(function(){if(result=='success'){prog(button.querySelector('svg.prog'),101);setTimeout(function(){window.location.href="/?success=suspended";},800)}else{errorAlerts(result);prog(button.querySelector('svg.prog'),102);setTimeout(function(){button.classList.remove('prog');},800)}},200)}});}
function deleteAccount(){var parent=document.querySelector('[data-name="delete_account_editables"]');var email=parent.querySelector('[data-name="del_acc_email"]').value;var pass=parent.querySelector('[data-name="del_acc_pwd"]').value;var button=parent.querySelector('[data-name="delete_account_submit"]');button.classList.add('prog');prog(button.querySelector('svg.prog'),99);var formData=new FormData;formData.append('mail',email);formData.append('action','PERM-DELETE');formData.append('pwd',pass);formData.append('rrrr',rrrr);if(ajaxRun){ajaxRun.abort();}
ajaxRun=$.ajax({type:"POST",url:"includes/deleteaccount.inc.php",data:formData,contentType:false,processData:false,success:function(result){setTimeout(function(){if(result=='success'){prog(button.querySelector('svg.prog'),101);setTimeout(function(){window.location.href="/?success=deleted";},800)}else{errorAlerts(result);prog(button.querySelector('svg.prog'),102);setTimeout(function(){button.classList.remove('prog');},800)}},200)}});}