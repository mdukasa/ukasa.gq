function initialOn(){getTxtData();if(document.body.getAttribute('data-status')=='meta'){document.querySelector('button.singular[name="edit_card_button"]').addEventListener('click',openEdit,false);document.querySelector('.card_setting[name="edit_connects"]').addEventListener('click',editConnects,false);document.querySelector('.card_setting[name="edit_bio"]').addEventListener('click',editBio,false);document.querySelector('.card_setting[name="edit_pfp"]').addEventListener('click',editPfp,false);document.querySelector('.card_setting[name="edit_color"]').addEventListener('click',editColor,false);document.querySelector('button.square_opener[data-open="account_buttons"]').addEventListener('click',openSquarePanel,false);document.querySelector('button[name="openSecurityButton"]').addEventListener('click',openSecurity,false);}
var connects=document.querySelector('biome.main_user_info .connections').querySelectorAll('connect');for(i=0;i<connects.length;i++){if(connects[i].classList.contains('text')){connects[i].addEventListener('click',openTxt,false);}else if(connects[i].classList.contains('link')){connects[i].addEventListener('click',clickLink,false);}}
document.querySelector('button.singular[name="exit_main_exp"]').addEventListener('click',exitExp,false);tabsCollapseOn();var alertPanelCloser=document.querySelector('[name="close_alert_panel"]');if(alertPanelCloser)alertPanelCloser.addEventListener('click',closePopPanels,false);var shareButton=document.querySelector('button[name="share_profile"]');if(shareButton){shareButton.addEventListener('click',openSquarePanel,false);document.querySelector('button[name="copy_profile_link"]').addEventListener('click',copyText,false);document.querySelector('button[name="copy_profile_embed"]').addEventListener('click',copyText,false);window.addEventListener('click',closeSquarePanels,false);}
scrollBarHeights();checkTooltips();setTimeout(function(){checkConnectOverflow();},200)}
function checkTooltips(){var tooltips=document.querySelectorAll('.tooltip_data');for(var i=0;i<tooltips.length;i++){tooltips[i].parentElement.addEventListener('mouseover',openTooltip,false);tooltips[i].parentElement.addEventListener('mouseout',openTooltip,false);tooltips[i].parentElement.addEventListener('touchstart',openTooltip,false);tooltips[i].parentElement.addEventListener('touchend',openTooltip,false);tooltips[i].parentElement.addEventListener('touchcancel',openTooltip,false);}}
function tabsCollapseOn(){var tabs=document.querySelectorAll('.tabs');for(var i=0;i<tabs.length;i++){var tab=tabs[i].querySelectorAll('button');for(var x=0;x<tab.length;x++){tab[x].addEventListener('click',changeTabs,false);}}}
function editConsOn(){document.querySelector('button.singular[name="exit_edit_cons"]').addEventListener('click',function(){closeRight('connect_info');},false);document.querySelector('scroll[name="pri_scroll"]').addEventListener('scroll',function(){headerShadow(event);},false);document.querySelector('scroll[name="sec_scroll"]').addEventListener('scroll',function(){headerShadow(event);},false);document.querySelector('button[name="open_add_con"]').addEventListener('click',openAddCon,false);conReorderOn();scrollBarHeights();}
function conReorderOn(){var allTiles=document.querySelector('.connect_openers').querySelectorAll('.connect_opener');if(isTouchEnabled()){for(var i=0;i<allTiles.length;i++){allTiles[i].addEventListener('touchstart',function(){readyReorder(event);},false);allTiles[i].addEventListener('contextmenu',function(){event.preventDefault();},false);allTiles[i].addEventListener('mousedown',function(){readyReorder(event);},false);}}else{for(var i=0;i<allTiles.length;i++){allTiles[i].addEventListener('mousedown',function(){readyReorder(event);},false);allTiles[i].addEventListener('contextmenu',function(){event.preventDefault();},false);}}}
function addConOn(){document.querySelector('.tabs button[name="add_text_tab"]').addEventListener('click',addTxtTabCheck,false);var scroll=document.querySelector('scroll.add_connect');scroll.addEventListener('scroll',headerShadow,false);var adds=scroll.querySelector('.text_editor .adds_container').querySelectorAll('button.add');for(i=0;i<adds.length;i++){adds[i].addEventListener('click',addTxtEl,false);}
document.querySelector('button[name="text_delete_mode"]').addEventListener('click',deleteMode,false);document.querySelector('button[name="submit_add_con"]').addEventListener('click',addTxtCon,false);document.querySelector('button[name="submit_add_txt_con"]').addEventListener('click',addTxtCon,false);document.querySelector('textarea[name="add_con_title"]').addEventListener('input',formatInput,false);document.querySelector('textarea[name="add_con_url"]').addEventListener('input',function(){formatInput(event);isLinkReady(event);},false);document.querySelector('button[name="expand_supp_platforms"]').addEventListener('click',openCloseCollapse,false);var exitButton=document.querySelector('button[name="exit_edit_con"]');exitButton.removeEventListener('click',checkTextEdited,false);exitButton.addEventListener('click',closeAddCon,false);document.querySelector('button[name="add_add_sect"]').addEventListener('click',addSectMenu,false);tabsCollapseOn();}
function sectOn(sect){if(isTouchEnabled()){sect.addEventListener('touchstart',readyReorder,false);sect.addEventListener('mousedown',readyReorder,false);}else{sect.addEventListener('mousedown',readyReorder,false);}
sect.addEventListener('contextmenu',function(){event.preventDefault();},false);var type=sect.getAttribute('data-type');if(type=='title'||type=='body'||type=='link'){sect.querySelector('textarea').addEventListener('input',delTxtEl,false);var tas=sect.querySelectorAll('textarea');for(i=0;i<tas.length;i++){tas[i].addEventListener('blur',deactEl,false);}}else if(type=='image'){var input=sect.querySelector('input');if(input){input.addEventListener('change',imageDrop,false);}}}
function editConOn(){autosize(document.querySelectorAll('textarea'));scrollBarHeights();document.querySelector('button[name="exit_edit_con"]').addEventListener('click',checkTextEdited,false);document.querySelector('button[name="delete_con"]').addEventListener('click',function(){sendAlert("Are you sure you want to delete this connection? This action cannot be undone","Yes, delete","delete",deleteCon)},false);document.querySelector('.con_main_info .resolve_buttons button.yep').addEventListener('click',changeCon,false);document.querySelector('.con_main_info .resolve_buttons [data-name="undo_con_changes"]').addEventListener('click',undoConEdit,false);var addContainer=document.querySelector('.edit_connect .text_editor .adds_container');document.querySelector('[name="submit_dates"]').addEventListener('click',getAnalytics,false);document.querySelector('button[name="open_con_share"]').addEventListener('click',openSquarePanel,false);var shareButtons=document.querySelector('.square_panel[name="share_con_buttons"]').querySelectorAll('button.square');for(var i=0;i<shareButtons.length;i++){shareButtons[i].addEventListener('click',copyText,false);}
var dateSelectors=document.querySelectorAll('.date_selector');for(var i=0;i<dateSelectors.length;i++){var input=dateSelectors[i].querySelector('input').addEventListener('input',updateDateSelector,false);}
if(addContainer){adds=addContainer.querySelectorAll('button.add');for(i=0;i<adds.length;i++){adds[i].addEventListener('click',addTxtEl,false);var type=adds[i].getAttribute('data-type');}
document.querySelector('button[name="edit_text_delete_mode"]').addEventListener('click',deleteMode,false);var sects=document.querySelector('.edit_connect .text_editor .add_text_layout').querySelectorAll('div.sect');for(var i=0;i<sects.length;i++){sectOn(sects[i]);if(sects[i].getAttribute('data-type')=='image'){var height=700*sects[i].getAttribute('data-ratio');var preCanvas=document.createElement('canvas');preCanvas.width=700;preCanvas.height=height;sects[i].appendChild(preCanvas);var id=sects[i].getAttribute('data-id');var container=sects[i];image=new Image();image.src=`includes/img.inc.php?id=${id}`;image.setAttribute('id',id);image.onload=function(){var thisId=this.getAttribute('id');var ratio=this.height/this.width;height=700*ratio;var canvas=document.createElement('canvas');canvas.width=700;canvas.height=height;var context=canvas.getContext("2d");context.scale(700/this.width,height/this.height);context.drawImage(this,0,0);var finalSect=document.querySelector(`.text_editor[name="edit_text_editor"] .sect.image[data-id="${thisId}"]`);finalSect.querySelector('canvas').remove();finalSect.appendChild(canvas);finalSect.classList.remove('loading');}}}
document.querySelector('button[name="submit_edit_text_con"]').addEventListener('click',editTxtCon,false);document.querySelector('button[name="edit_add_sect"]').addEventListener('click',addSectMenu,false);localTextEditBackup();var scroll=document.querySelector('scroll.edit_connect');scroll.addEventListener('scroll',checkLayoutPos,false);scroll.addEventListener('scroll',headerShadow,false);setTimeout(function(){if(scroll.offsetHeight>=scroll.scrollHeight){scroll.querySelector('.action_bar').classList.add('active');}},300)}
tabsCollapseOn();var mainInfoEdit=document.querySelector('.edit_connect .con_main_info_edit');mainInfoEdit.querySelector('textarea.title').addEventListener('input',checkTextArea,false);var urlInput=mainInfoEdit.querySelector('textarea.url');if(urlInput){urlInput.addEventListener('input',checkTextArea,false);urlInput.addEventListener('input',formatInput,false);}}
function editPfpOn(){document.querySelector('input[name="replace_pfp"]').addEventListener('input',pfpPreview,false);document.querySelector('button[name="undo_edit_pfp"]').addEventListener('click',undoPfpChanges,false);document.querySelector('button[name="unlink_pfp"]').addEventListener('click',unlinkPfp,false);document.querySelector('button[name="edit_pfp_submit"]').addEventListener('click',changePfp,false);document.querySelector('button[name="exit_pfp_edit"]').addEventListener('click',function(){closeRight("edit_pfp");},false);var shapes=document.querySelector('.shape_chooser').querySelectorAll('.shape');for(var i=0;i<shapes.length;i++){shapes[i].addEventListener('click',changeShape,false);}
document.querySelector('scroll.edit_pfp').addEventListener('scroll',function(){scrollbar(event);headerShadow(event);pfpMiniView(event);},false);document.querySelector('[data-name="main_pfp_edit_preview"]').addEventListener('click',function(){document.querySelector('input[name="replace_pfp"]').click();})
scrollBarHeights();checkTooltips();}
function editColorOn(){document.querySelector('input[name="edit_color_picker"]').addEventListener('input',changeFromColIn,false);document.querySelector('input[name="edit_color_hex"]').addEventListener('input',correctHex,false);document.querySelector('div[name="edit_color_from_pfp"]').addEventListener('click',loadVibrant,false);document.querySelector('button[name="edit_color_submit"]').addEventListener('click',changeColor,false);document.querySelector('button[name="undo_edit_color"]').addEventListener('click',undoColorChanges,false);document.querySelector('button[name="exit_color_edit"]').addEventListener('click',function(){closeRight("edit_color");},false);document.querySelector('button[name="edit_color_theme"]').addEventListener('click',toggleTheme,false);document.querySelector('scroll.edit_color').addEventListener('scroll',function(){scrollbar(event);headerShadow(event);},false);var bgContainer=document.querySelector('[data-name="edit_bg_container"]');if(bgContainer){var bgRolls=bgContainer.querySelectorAll('roll');for(var i=0;i<bgRolls.length;i++){bgRolls[i].addEventListener('mouseenter',bgRollHover,false);bgRolls[i].addEventListener('mouseleave',bgRollHoverOut,false);bgRolls[i].addEventListener('click',setBackground,false);bgRolls[i].addEventListener('contextmenu',function(){event.preventDefault();},false);}
setTimeout(function(){document.querySelector('[data-name="no_wallpaper_selector"]').addEventListener('click',setBackground,false);resetBGRolls();var openRoll=document.querySelector('[data-name="edit_bg_container"] roll.active');if(openRoll)bgRollIn(openRoll,0);},700)}
scrollBarHeights();checkTooltips();}
function editBioOn(){document.querySelector('textarea[name="edit_bio_name"]').addEventListener('input',ifTextEdits,false);document.querySelector('textarea[name="edit_bio_bio"]').addEventListener('input',ifTextEdits,false);document.querySelector('button[name="undo_edit_bio"]').addEventListener('click',undoBioChanges,false);document.querySelector('button[name="edit_bio_submit"]').addEventListener('click',changeBio,false);document.querySelector('button[name="exit_edit_bio"]').addEventListener('click',function(){closeRight("bio_info")},false);document.querySelector('scroll.edit_bio').addEventListener('scroll',function(){scrollbar(event);headerShadow(event);},false);scrollBarHeights;}
function securityPanelOn(){var main=document.querySelector('.change_password_content');main.querySelector('input[name="cur_pwd"]').addEventListener('input',checkPassword,false);main.querySelector('input[name="new_pwd"]').addEventListener('input',checkPassword,false);main.querySelector('input[name="re_new_pwd"]').addEventListener('input',checkPassword,false);checkTooltips();document.querySelector('button[name="exit_security"]').addEventListener('click',function(){closeRight()},false);main.querySelector('button[name="edit_pass_submit"]').addEventListener('click',changePassword,false);document.querySelector('[name="clear_remember_me"]').addEventListener('click',clearRememberMe,false);document.querySelector('[data-name="toggle_midnight_mode"]').addEventListener('click',toggleMidnightMode,false);document.querySelector('[data-name="suspend_account_submit"]').addEventListener('click',suspendAccount,false);document.querySelector('[data-name="delete_account_submit"]').addEventListener('click',deleteAccount,false);var allCollapses=document.querySelector('scroll.security_panel').querySelectorAll('span.editables');for(var i=0;i<allCollapses.length;i++){allCollapses[i].querySelector('.collapse_button').addEventListener('click',settingsCollapse,false);}
var showPwds=document.querySelectorAll('button.show_password');for(var i=0;i<showPwds.length;i++){showPwds[i].addEventListener('click',showPassword,false);}}